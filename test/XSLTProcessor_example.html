<!DOCTYPE html>

<script>window.xsltUsePolyfillAlways = true;</script>
<script src="../xslt-polyfill.min.js" charset="utf-8"></script>

<div id="results"></div>

<script>
xsltPolyfillReady().then(() => {
  const xmlString = `
  <page>
   <message>
    Hello World.
   </message>
  </page>
  `;

  const xsltString = `
  <xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:template match="/page/message">
      <root>
        <p>Should be green:</p>
        <div xmlns="http://www.w3.org/1999/xhtml" style="color:green">
          <xsl:value-of select="." />
        </div>
      </root>
    </xsl:template>
  </xsl:stylesheet>`;

  const parser = new DOMParser();
  const xmlDoc = parser.parseFromString(xmlString, "application/xml");
  const xsltDoc = parser.parseFromString(xsltString, "application/xml");

  const xsltProcessor = new XSLTProcessor();
  xsltProcessor.importStylesheet(xsltDoc);
  const result = xsltProcessor.transformToFragment(xmlDoc, document);
  document.getElementById("results").append(result);
});
</script>
